# Инструкция по настройке Планировщика задач Windows

## Шаги для создания задачи в Планировщике задач Windows:

### 1. Откройте Планировщик задач
- Нажмите Win+R и введите `taskschd.msc`
- Или найдите "Планировщик задач" в меню Пуск

### 2. Создайте новую задачу
- В правой панели выберите "Создать задачу..."

### 3. Вкладка "Общие"
- **Имя:** CRM Call Automation
- **Описание:** Автоматический запуск обработки звонков CRM
- **Параметры безопасности:**
  - ✓ Выполнять вне зависимости от регистрации пользователя
  - ✓ Выполнить с наивысшими правами (если требуется)
  - Настроить для: Windows 10

### 4. Вкладка "Триггеры"
Нажмите "Создать..." и выберите один из вариантов:

#### Ежедневный запуск:
- Начать задачу: По расписанию
- Параметры: Ежедневно
- Начать: выберите дату и время (например, 09:00)
- Повторять каждые: 1 дн.

#### Запуск каждый час:
- Начать задачу: По расписанию
- Параметры: Ежедневно
- В дополнительных параметрах:
  - ✓ Повторять задачу каждые: 1 час
  - В течение: Бесконечно

### 5. Вкладка "Действия"
- Нажмите "Создать..."
- Действие: Запуск программы
- Программа или сценарий: `C:\Users\user\PycharmProjects\CRM_call\run_crm_automation.bat`
- Рабочая папка: `C:\Users\user\PycharmProjects\CRM_call`

### 6. Вкладка "Условия"
- Снимите галочку "Запускать задачу при питании от электросети"
- При необходимости настройте другие условия

### 7. Вкладка "Параметры"
- ✓ Разрешить выполнение задачи по требованию
- ✓ Останавливать задачу, выполняемую дольше: 2 часа
- При сбое выполнения перезапускать через: 5 минут
- Число попыток перезапуска: 3

### 8. Сохраните задачу
- Нажмите "ОК"
- Введите пароль пользователя Windows

## Проверка работы

### Ручной запуск:
1. Найдите созданную задачу в списке
2. Щелкните правой кнопкой мыши
3. Выберите "Выполнить"

### Просмотр истории:
1. Выберите задачу
2. Перейдите на вкладку "Журнал" внизу

## Полезные команды PowerShell

```powershell
# Просмотр задачи
Get-ScheduledTask -TaskName "CRM Call Automation"

# Запуск задачи
Start-ScheduledTask -TaskName "CRM Call Automation"

# Отключение задачи
Disable-ScheduledTask -TaskName "CRM Call Automation"

# Включение задачи
Enable-ScheduledTask -TaskName "CRM Call Automation"
```

## Устранение неполадок

1. **Скрипт не запускается:**
   - Проверьте путь к bat файлу
   - Убедитесь, что Python установлен и доступен
   - Проверьте активацию виртуального окружения

2. **Ошибки разрешений:**
   - Запустите с правами администратора
   - Проверьте права доступа к папке проекта

3. **Логи:**
   - Проверьте папку `logs` в директории проекта
   - Просмотрите журнал событий Windows